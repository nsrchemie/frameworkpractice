<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <title>Simple Leaflet Map</title>
    <meta charset="utf-8" />
    <link 
        rel="stylesheet" 
        href="http://cdn.leafletjs.com/leaflet-0.7/leaflet.css"
    />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    



    <link href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOzvcYDk54HGGhv8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFjyBTEx7dkrK/v/ODjidwAAAAAAAAAAAAAAAGNj/wSUlP8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADo62lMrK/z/Kir//zAw7+hQUOsMODjebDIy7LszM+XsWVnqDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1NeOHKir//yoq//8uLvH8MzPq0Soq/v8qKv//MTHu1gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEND2x87O9dOOTnbmyoq//8qKv//Li7u/yoq//8qKv//Kir//zQ055QAAAAAAAAAAAAAAAAAAAAAOLdsG0FUzD0uLu/8Kir+/yws9v8vL+z/JCTp/ykp5/8eHuv/JCT5/yws+P8+PtpTAAAAAAAAAAAAAAAAAAAAADfEcQoyr2WrMUzP/Coq//8rK/z/Kirh/yIiy/8ZGdX/HR3f/yoq5/8tLfH/Li7y+Tc345FLS+QJAAAAAAAAAAAAAAAAO7x2DTOEjbcsLvT/Kyv5/ysr6v8SErj/Fxe+/yAg1/8gIPT/Kir//yoq//8qKv7/MzPpx0ZG4BE2smxGMKxjjTKzZYA0uWuSMlW89S0t8f8wMOf/ICDZ/yEhyv8pKen/Kir//yoq//8qKv//Kir//yoq//80NOjDAAAAADm8cBY0tGh8M6Rz/S0u8v8qKv//Kir+/y4u8P8sLPP/Jibu/zAw5f4vL/H6LCz1/y0t8/4zM+vDPT3ZSE/pmAIztWljM7Zn5jV3n8gqKv//Kir//yoq//8sLPf/LCz2/yoq//8rK/r/Pz/bVkhI5B5GRuMVbGz/AAAAAAA1s2loMa5kbje7chk4ONpjKir//yoq//8qKv7/NDTkzy4u9PcqKv//Kir//zc33msAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQUHXKi4u8P8vL/DxNjbjjUtL4wpBQdovMTHu3yoq//84ONxqAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhY/wJDQ9olXV3/BQAAAAAAAAAAAAAAAERE3Bc1NeScPj7ZPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAPx/AAD4cwAA+AMAAPgHAADgBwAAgAcAAIABAADAAAAAAAAAAIAAAAAAAQAAAA8AAOAPAADjjwAA//8AAA==" rel="icon" type="image/x-icon">
</head>
<body>
<style>
* {
	margin:0;
	padding:0;

}
body {
	background-color:#043131;
}
div.contain {
	float:right;

/*	margin-right:50em;*/
/*	width:30em;*/
	display:inline-block;
	overflow: scroll;
	height:50em;
	width:30em;
}
div.sitings {
	width:28.125em;
	padding:.625em;
	border: .312em outset #4c614e;
/*	outline-width: 10%;*/
/*	border-left-width:300px;*/
	margin:.625em;
	position:right;
	left:70%;
	background-color: #5C755E;
	color:white;
}
div.sitings a{
	color:#c8f7c5;
}
#show_form {
/*	display:inline-block;*/
}
#addition_form {
	top:2em;
	background-color: #0AC66D;
	width:28.125em;
	display:inline-block;
}
div.Phytoheader {
	background-color: #0BC67C;
	display:inline-block;
	width:100%;
	border-bottom-style:groove;
	border-bottom:thick;
}
h1.headtitle {
	color:white;
	margin-left: .6em;
	font-size: 22px;
	margin-bottom:.9em;
	font-family: "Trebuchet MS", Helvetica, sans-serif;
}



</style>

<div class="Phytoheader">
    <h1 class="headtitle">Phytomap</h1>
</div>
<div class="contain">
{% for post in posts %}
    <div class ="sitings">
        
        <h1><a href="">{{ post.title }}</a></h1>
        <p>{{ post.text|linebreaks }}</p>
        <h4>{{post.description}}</h4>
        <img src={{ post.picture.url }} height="200px" width="320px" border="1px"/><p>published: {{ post.published_date }}</p>
    </div>
{% endfor %}
</div>
<!-- <h3 id='location'></h3>    -->
<div id="map" style="width: 86.37em; height:57em; margin-top:.8em; box-shadow: 3px 3px 10px 5px #000;"></div>
<button id="show_form">Add a new siting!</button>
<form id ='addition_form' action="{% url 'post_list' %}" method="POST" enctype="multipart/form-data" action=''>
<!-- <form action="{{ action }}" method="POST"> -->
  {% csrf_token %}
 <!--  {% if form.non_field_errors %}
    <ul>
      {% for error in form.non_field_errors %}
        <li>{{ error }}</li>
      {% endfor %}
    </ul>
  {% endif %}
  {% for field in form %}
  <div id="{{ field.auto_id }}_container">
    {{ field.help_text }}
    <div>
      {{ field.label_tag }} {{ field }}
    </div>
    <div id="{{ field.auto_id }}_errors">
      {{ field.errors }}
    </div>
  </div>
  {% endfor %}
 -->

<!--   <input id="save_contact" type="submit" value="Save" /> -->
{{form.as_p}}
<input type="submit" value="Submit" />
</form>
<p id='lat'></p>

</form>




 
</body>

<script src="http://cdn.leafletjs.com/leaflet-0.7/leaflet.js">
</script>


<script>
$(document).ready(function(){
	var lat = $('#addition_form');
	lat.hide();

});
$('#show_form').click(function(){
	// var showform = document.getElementById("#addition_form");
	// showform.style.display = "block";
	$("#addition_form").toggle()

	function addMarker(e){
    var newMarker = new L.marker(e.latlng).addTo(map);
    	var m = newMarker.getLatLng();
		$('#id_location').val(m.lat + ',' + m.lng);
		map.off("click");
    	// loc = ;
    	// $('#id_location').html(loc);


    	// $("#id_location").text(m.lat + ',' + m.lng);
    	// $("#id_location").text();
};
map.on('click', addMarker);
});



    // $("#map").on('click', onClick);

    // function onClick(d) {
    //     var title
    //     var marker_title = "#" + d.target.options.title.toLowerCase();
    //     if ( $(marker_title) ){
    //    // Call up the video.
    //        alert("Marker ID is: " + marker_title);
    //    }
    // };
// class="post-form" enctype="multipart/form-data"

// var planes;
// {% for post in posts %}
// 	planes += [["'{{post.title}}'" + ',' + {{post.location}} + ',' + "'<img src={{post.picture.url}} height='200' width='280'>'"]];
// 	console.log(planes.length)
// {% endfor %}
// console.log(planes);
// [[{{post.title}}, {{post.location}}, "<img src={{post.picture.url}}">];

	// var planes = [
	// 	["Vancouveria sp.",45.535449,-122.724988, "<img src = https://www.nargs.org/sites/default/files/forum-images/Vancouveria_hexandra_05-26-2010rs2.jpg height='200' width='280'>"],
	// 	// ["7C6B38",-41.30269,173.63696],
	// 	// ["7C6CA1",-41.49413,173.5421],
	// 	// ["7C6CA2",-40.98585,174.50659],
	// 	// ["C81D9D",-40.93163,173.81726],
	// 	// ["C82009",-41.5183,174.78081],
	// 	// ["C82081",-41.42079,173.5783],
	// 	// ["C820AB",-42.08414,173.96632],
	// 	// ["C820B6",-41.51285,173.53274]
	// 	];
	// 	console.log(planes.length);
		var portland = [45.5200, -122.6819]
		var defaultzoom = 8
        var map = L.map('map').setView(portland, defaultzoom);
        var newMarker;
        mapLink = 
            '<a href="http://openstreetmap.org">OpenStreetMap</a>';
        L.tileLayer(
            'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; ' + mapLink + ' Contributors',
            maxZoom: 18,
            }).addTo(map);
{% for post in posts %}
		// for (var i = 0; i < planes.length; i++) {
			marker = new L.marker([{{post.location}}],
                {title : "{{post.title}}"})
				.bindPopup("<img src={{post.picture.url}} height='200' width='280'>")
				.addTo(map);
{% endfor %}


        // newMarkerGroup = new L.LayerGroup();

		// }

// var coordinates = document.getElementById('location');
// function addMarker(e){
//     var newMarker = new L.marker(e.latlng).addTo(map);
//     	var m = newMarker.getLatLng()
//     	coordinates.innerHTML = 'Lat: ' + m.lat + '<br>Long: ' + m.lng;
// }
// map.on('click', addMarker);



// var submitnewplant = $('#')

// function saveMarker(e){
//     planes.append()}
    </script>



